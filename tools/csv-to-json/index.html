<!doctype html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow" />

  <title>CSVâ†’JSON å¤‰æ›ãƒ„ãƒ¼ãƒ«ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨ãƒ»è‡ªå‹•å¤‰æ›ãƒ»Shift-JISå¯¾å¿œï¼‰ | ConvertFileBox</title>
  <meta name="description"
    content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã¶ã ã‘ã§JSONã«è‡ªå‹•å¤‰æ›ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨ï¼‰ã€‚Shift-JIS/UTF-8/UTF-16å¯¾å¿œã€‚ç„¡æ–™ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶å®Œçµã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã€‚å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã›ã‚“ã€‚" />
  <link rel="canonical" href="https://www.convertfilebox.net/tools/csv-to-json/" />

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2739559953649909"
    crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2M7JXDP7J8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-2M7JXDP7J8');
  </script>

  <style>
    /* Tool Specific Overlay Styles */
    /* Tool Specific Overlay Styles */
    .settings-panel {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 1rem;
      margin-bottom: 1.5rem;
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-main);
    }

    .form-select,
    .form-input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.9375rem;
      background-color: white;
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9375rem;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <header class="site-header">
    <div class="container flex items-center justify-between" style="height: 100%;">
      <a href="/" class="brand">
        <div class="brand-logo" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
            <polyline points="14 2 14 8 20 8" />
            <path d="M8 13h8" />
            <path d="M8 17h8" />
            <path d="M10 9h4" />
          </svg>
        </div>
        <div>
          ConvertFileBox
          <span class="text-xs text-muted" style="display:block; font-weight:400; line-height:1;">ç„¡æ–™ãƒ„ãƒ¼ãƒ«é›†</span>
        </div>
      </a>

      <button id="mobile-menu-btn" class="mobile-menu-btn" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>

      <nav id="nav-links" class="nav-links">
        <a href="/" class="nav-link">ãƒ›ãƒ¼ãƒ </a>
        <a href="/tools/" class="nav-link active">ãƒ„ãƒ¼ãƒ«ä¸€è¦§</a>
        <a href="/about/" class="nav-link">ã“ã®ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a>
      </nav>
    </div>
  </header>

  <main class="container mt-8 mb-8" style="max-width: 960px;">
    <div class="text-center mb-8">
      <h1>CSV â†’ JSON å¤‰æ›</h1>
      <p class="text-muted mt-2">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã¶ã ã‘ã§JSONã«è‡ªå‹•å¤‰æ›ã—ã¾ã™ã€‚æ–‡å­—åŒ–ã‘ã™ã‚‹å ´åˆã¯è¨­å®šã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ãã ã•ã„ã€‚</p>
      <div class="flex justify-center gap-4 mt-4">
        <span class="tag">ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—</span>
        <a href="/tools/csv-to-json-paste/" class="text-sm text-primary" style="text-decoration:underline">è²¼ã‚Šä»˜ã‘ç‰ˆã¯ã“ã¡ã‚‰</a>
      </div>
    </div>

    <!-- Security Block -->
    <div class="panel mb-8">
      <h2 class="text-lg font-bold mb-4">ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¤ã„ã¦</h2>
      <p class="mb-4 font-bold">å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚å‡¦ç†ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã—ã¾ã™ã€‚</p>
      <ul class="list-disc list-inside text-sm text-muted mb-6 pl-4">
        <li>ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã›ã‚“ï¼ˆå¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¸é€ä¿¡ã—ã¾ã›ã‚“ï¼‰</li>
        <li>å…¥åŠ›å†…å®¹ã¯ã‚µãƒ¼ãƒãƒ¼å´ã§ä¿å­˜ãƒ»è§£æã—ã¾ã›ã‚“</li>
        <li>ä¼šç¤¾ãƒ»æ¥­å‹™ç”¨ã®CSV/JSONã§ã‚‚å®‰å¿ƒã—ã¦ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™</li>
      </ul>
      <div class="flex flex-wrap gap-2">
        <span class="tag">ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—</span>
        <span class="tag">ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµ</span>
        <span class="tag">ãƒ­ã‚°ä¿å­˜ãªã—</span>
        <span class="tag">ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦</span>
      </div>
    </div>

    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">

      <!-- Left Column: Input & Settings -->
      <div class="flex flex-col gap-4">
        <div class="panel">
          <h2 class="text-lg font-bold mb-4">1. è¨­å®š</h2>
          <div class="grid grid-2" style="gap: 1rem;">
            <div class="form-group">
              <label for="delimiter">åŒºåˆ‡ã‚Šæ–‡å­—</label>
              <select id="delimiter" class="form-select">
                <option value="," selected>ã‚«ãƒ³ãƒ (,)</option>
                <option value="tab">ã‚¿ãƒ– (\t)</option>
                <option value=";">ã‚»ãƒŸã‚³ãƒ­ãƒ³ (;)</option>
              </select>
            </div>
            <div class="form-group">
              <label for="fileEncoding">æ–‡å­—ã‚³ãƒ¼ãƒ‰</label>
              <select id="fileEncoding" class="form-select">
                <option value="shift_jis" selected>Shift-JIS</option>
                <option value="utf-8">UTF-8</option>
                <option value="utf-8-bom">UTF-8ï¼ˆBOMä»˜ãï¼‰</option>
                <option value="utf-16le">UTF-16LE</option>
                <option value="utf-16be">UTF-16BE</option>
              </select>
            </div>
          </div>
          <div class="mt-2">
            <label class="checkbox-wrapper">
              <input type="checkbox" id="hasHeader" checked />
              <span>1è¡Œç›®ã¯ãƒ˜ãƒƒãƒ€ã¨ã—ã¦æ‰±ã†</span>
            </label>
          </div>
        </div>

        <div class="panel">
          <h2 class="text-lg font-bold mb-4">2. ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ</h2>
          <label class="file-drop-area" id="dropArea">
            <input type="file" id="fileInput" class="file-input" accept=".csv,text/csv,.txt,text/plain" />
            <div style="font-size: 2rem; color: var(--text-light); margin-bottom: 0.5rem;">ğŸ“‚</div>
            <p class="font-bold text-main">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ ã¾ãŸã¯ ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p>
            <p class="text-sm text-muted mt-2">.csv, .txt</p>
          </label>
          <div id="fileInfo" class="alert alert-info mt-4" style="display:none">
            <span id="fileName">files.csv</span> <span class="text-xs opacity-75" id="fileSize"></span>
          </div>
          <div id="errorMsg" class="alert alert-warning mt-4 hide" style="display:none"></div>
        </div>
      </div>

      <!-- Right Column: Output -->
      <div class="flex flex-col gap-4">
        <div class="panel" style="height: 100%; display: flex; flex-direction: column;">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-bold">3. å¤‰æ›çµæœ</h2>
            <div class="flex gap-2">
              <button class="btn btn-secondary btn-sm" id="btnCopy" disabled>ã‚³ãƒ”ãƒ¼</button>
              <button class="btn btn-primary btn-sm" id="btnDownload" disabled>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
            </div>
          </div>

          <div id="statInfo" class="text-xs text-muted mb-2 min-h-[1.5em]"></div>

          <textarea id="outputText" class="code-editor" readonly placeholder="ã“ã“ã«JSONãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼‰"
            style="flex:1; min-height: 400px;"></textarea>
        </div>
      </div>

    </div>

  </main>

  <footer class="site-footer">
    <div class="container text-center">
      <div class="flex justify-center gap-4 mb-4 text-sm text-muted">
        <a href="/tools/">ãƒ„ãƒ¼ãƒ«ä¸€è¦§</a>
        <a href="/about/">ã“ã®ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a>
        <a href="/privacy/">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
      </div>
      <div class="text-xs text-muted">
        &copy; <span id="year">2026</span> ConvertFileBox. <br>
        å¤‰æ›çµæœã®æ­£ç¢ºæ€§ã¯ä¿è¨¼ã—ã¾ã›ã‚“ï¼ˆè‡ªå·±è²¬ä»»ã§ã”åˆ©ç”¨ãã ã•ã„ï¼‰ã€‚
      </div>
    </div>
  </footer>

  <script src="/assets/js/ui.js"></script>
  <script>
    const $ = (id) => document.getElementById(id);

    const delimiterEl = $("delimiter");
    const hasHeaderEl = $("hasHeader");
    const fileEncodingEl = $("fileEncoding");
    const fileInputEl = $("fileInput");
    const dropArea = $("dropArea");

    const outputEl = $("outputText");
    const errorMsgEl = $("errorMsg");
    const fileInfoEl = $("fileInfo");
    const fileNameEl = $("fileName");
    const statInfoEl = $("statInfo");

    const btnCopy = $("btnCopy");
    const btnDownload = $("btnDownload");

    let lastSelectedFile = null;
    let lastJsonText = "";

    function setError(text) {
      if (!text) {
        errorMsgEl.style.display = "none";
        return;
      }
      errorMsgEl.textContent = text;
      errorMsgEl.style.display = "block";
    }

    function setStat(text) { statInfoEl.textContent = text || ""; }

    function normalizeNewlines(s) {
      return s.replace(/\r\n/g, "\n").replace(/\r/g, "\n");
    }

    function decodeArrayBuffer(buf, encSel) {
      const enc = (encSel === "utf-8-bom") ? "utf-8" : encSel;
      let text = "";
      try {
        text = new TextDecoder(enc, { fatal: false }).decode(buf);
      } catch (e) {
        text = new TextDecoder("utf-8", { fatal: false }).decode(buf);
      }
      if (text.startsWith("\uFEFF")) text = text.slice(1);
      return text.replace(/\u0000/g, "");
    }

    function parseCSV(text, delimiterChar) {
      const delim = delimiterChar === "tab" ? "\t" : delimiterChar;
      const s = normalizeNewlines(text);

      const rows = [];
      let i = 0, field = "", row = [], inQuotes = false;

      while (i < s.length) {
        const ch = s[i];

        if (inQuotes) {
          if (ch === '"') {
            if (s[i + 1] === '"') { field += '"'; i += 2; continue; }
            inQuotes = false; i++; continue;
          } else {
            field += ch; i++; continue;
          }
        } else {
          if (ch === '"') { inQuotes = true; i++; continue; }
          if (ch === delim) { row.push(field); field = ""; i++; continue; }
          if (ch === "\n") { row.push(field); rows.push(row); field = ""; row = []; i++; continue; }
          field += ch; i++; continue;
        }
      }
      row.push(field);
      rows.push(row);

      while (rows.length && rows[rows.length - 1].length === 1 && rows[rows.length - 1][0].trim() === "") rows.pop();
      return rows;
    }

    function safeKey(s, idx) {
      const t = (s ?? "").trim();
      if (!t) return `col${idx + 1}`;
      return t.replace(/\s+/g, "_").replace(/[^\w\-ã-ã‚“ã‚¡-ãƒ³ä¸€-é¾¥]/g, "_");
    }

    function csvToJson(text) {
      const rows = parseCSV(text, delimiterEl.value);
      if (!rows.length) return { json: [], headers: [], rowsCount: 0 };

      let headers = [];
      let start = 0;

      if (hasHeaderEl.checked) {
        headers = rows[0].map((h, i) => safeKey(h, i));
        start = 1;
      } else {
        const maxCols = Math.max(...rows.map(r => r.length));
        headers = Array.from({ length: maxCols }, (_, i) => `col${i + 1}`);
      }

      const json = rows.slice(start).map(r => {
        const o = {};
        for (let i = 0; i < headers.length; i++) {
          o[headers[i]] = (r[i] ?? "");
        }
        return o;
      });

      return { json, headers, rowsCount: rows.length };
    }

    async function reloadAndConvert() {
      if (!lastSelectedFile) return;

      // Show file info
      fileInfoEl.style.display = "block";
      fileNameEl.textContent = lastSelectedFile.name;
      setError("");

      try {
        const ab = await lastSelectedFile.arrayBuffer();
        const text = decodeArrayBuffer(ab, fileEncodingEl.value);

        const { json, headers, rowsCount } = csvToJson(text);

        lastJsonText = JSON.stringify(json, null, 2);
        outputEl.value = lastJsonText;

        btnCopy.disabled = (json.length === 0);
        btnDownload.disabled = (json.length === 0);

        setStat(`å¤‰æ›å®Œäº†: è¡Œæ•°=${rowsCount} / JSONä»¶æ•°=${json.length} / åˆ—æ•°=${headers.length}`);

        if (rowsCount <= 1 && hasHeaderEl.checked) {
          setError("ãƒ‡ãƒ¼ã‚¿è¡ŒãŒ0ä»¶ã§ã™ã€‚ãƒ˜ãƒƒãƒ€è¨­å®šã‚„CSVå½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
        }
        if (headers.length <= 1) {
          setError("æ³¨: åˆ—æ•°ãŒ1ã§ã™ã€‚åŒºåˆ‡ã‚Šæ–‡å­—ãŒé•ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚");
        }

      } catch (e) {
        console.error(e);
        lastJsonText = "";
        outputEl.value = "";
        btnCopy.disabled = true;
        btnDownload.disabled = true;
        setError("å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
      }
    }

    // File Drop Events
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
    });
    function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, () => dropArea.classList.add('dragover'), false);
    });
    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, () => dropArea.classList.remove('dragover'), false);
    });

    dropArea.addEventListener('drop', (e) => {
      const dt = e.dataTransfer;
      const files = dt.files;
      if (files && files[0]) {
        fileInputEl.files = files; // update input
        lastSelectedFile = files[0];
        reloadAndConvert();
      }
    });

    // Events
    fileInputEl.addEventListener("change", async (e) => {
      const f = e.target.files && e.target.files[0];
      if (!f) return;
      lastSelectedFile = f;
      await reloadAndConvert();
    });

    delimiterEl.addEventListener("change", reloadAndConvert);
    hasHeaderEl.addEventListener("change", reloadAndConvert);
    fileEncodingEl.addEventListener("change", reloadAndConvert);

    btnCopy.addEventListener("click", () => {
      if (!lastJsonText) return;
      copyToClipboard(lastJsonText, btnCopy);
    });

    btnDownload.addEventListener("click", () => {
      if (!lastJsonText) return;
      const base = (lastSelectedFile?.name || "converted").replace(/\.[^.]+$/, "");
      const blob = new Blob([lastJsonText], { type: "application/json;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `${base}.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });
  </script>
</body>

</html>