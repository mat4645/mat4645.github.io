<!doctype html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow" />

  <title>JSONâ†’CSV å¤‰æ›ãƒ„ãƒ¼ãƒ«ï¼ˆé…åˆ—JSONå¯¾å¿œãƒ»ç„¡æ–™ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶å®Œçµï¼‰ | ConvertFileBox</title>
  <meta name="description"
    content="JSONï¼ˆé…åˆ—/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã‚’CSVã«å¤‰æ›ã€‚ãƒ˜ãƒƒãƒ€è‡ªå‹•ç”Ÿæˆãƒ»åŒºåˆ‡ã‚Šæ–‡å­—æŒ‡å®šãƒ»ãƒã‚¹ãƒˆã®ãƒ•ãƒ©ãƒƒãƒˆåŒ–ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯¾å¿œã€‚ç„¡æ–™ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶å®Œçµã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã€‚å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã›ã‚“ã€‚" />
  <link rel="canonical" href="https://www.convertfilebox.net/tools/json-to-csv/" />

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/theme-neubrutal.css">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2739559953649909"
    crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2M7JXDP7J8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-2M7JXDP7J8');
  </script>

  <style>
    .form-select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.9375rem;
      background-color: white;
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9375rem;
      cursor: pointer;
    }

    .split-pane {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    @media (min-width: 960px) {
      .split-pane {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>

<body>

  <header class="site-header">
    <div class="container flex items-center justify-between" style="height: 100%;">
      <a href="/" class="brand">
        <div class="brand-logo" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
            <polyline points="14 2 14 8 20 8" />
            <path d="M8 13h8" />
            <path d="M8 17h8" />
            <path d="M10 9h4" />
          </svg>
        </div>
        <div>
          ConvertFileBox
          <span class="text-xs text-muted" style="display:block; font-weight:400; line-height:1;">ç„¡æ–™ãƒ„ãƒ¼ãƒ«é›†</span>
        </div>
      </a>

      <button id="mobile-menu-btn" class="mobile-menu-btn" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>

      <nav id="nav-links" class="nav-links">
        <a href="/" class="nav-link">ãƒ›ãƒ¼ãƒ </a>
        <a href="/tools/" class="nav-link active">ãƒ„ãƒ¼ãƒ«ä¸€è¦§</a>
        <a href="/about/" class="nav-link">ã“ã®ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a>
      </nav>
    </div>
  </header>

  <main class="container mt-8 mb-8" style="max-width: 1280px;">
    <div class="text-center mb-8">
      <h1>JSON â†’ CSV å¤‰æ›</h1>
      <p class="text-muted mt-2">JSONï¼ˆé…åˆ—/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã‚’CSVã«å¤‰æ›ã—ã¾ã™ã€‚ãƒã‚¹ãƒˆã®ãƒ•ãƒ©ãƒƒãƒˆåŒ–ã‚‚å¯èƒ½ã§ã™ã€‚</p>
      <div class="flex justify-center gap-4 mt-4">
        <span class="tag">ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—</span>
        <button id="btnSample" class="text-sm text-primary"
          style="background:none; border:none; text-decoration:underline; cursor:pointer;">ã‚µãƒ³ãƒ—ãƒ«ã‚’å…¥åŠ›</button>
      </div>
    </div>

    <!-- Security Block -->
    <div class="panel mb-8">
      <h2 class="text-lg font-bold mb-4">ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¤ã„ã¦</h2>
      <p class="mb-4 font-bold">å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚å‡¦ç†ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã—ã¾ã™ã€‚</p>
      <ul class="list-disc list-inside text-sm text-muted mb-6 pl-4">
        <li>ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã›ã‚“ï¼ˆå¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¸é€ä¿¡ã—ã¾ã›ã‚“ï¼‰</li>
        <li>å…¥åŠ›å†…å®¹ã¯ã‚µãƒ¼ãƒãƒ¼å´ã§ä¿å­˜ãƒ»è§£æã—ã¾ã›ã‚“</li>
        <li>ä¼šç¤¾ãƒ»æ¥­å‹™ç”¨ã®CSV/JSONã§ã‚‚å®‰å¿ƒã—ã¦ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™</li>
      </ul>
      <div class="flex flex-wrap gap-2">
        <span class="tag">ã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—</span>
        <span class="tag">ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµ</span>
        <span class="tag">ãƒ­ã‚°ä¿å­˜ãªã—</span>
        <span class="tag">ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦</span>
      </div>
    </div>

    <div class="panel mb-6">
      <div class="flex flex-wrap items-center gap-6">
        <div style="min-width: 150px;">
          <label class="text-xs font-bold text-muted mb-1 block">åŒºåˆ‡ã‚Šæ–‡å­—</label>
          <select id="delim" class="form-select">
            <option value="," selected>ã‚«ãƒ³ãƒ (,)</option>
            <option value="tab">ã‚¿ãƒ– (\t)</option>
            <option value=";">ã‚»ãƒŸã‚³ãƒ­ãƒ³ (;)</option>
          </select>
        </div>
        <div class="flex flex-col gap-2">
          <label class="checkbox-wrapper">
            <input type="checkbox" id="includeHeader" checked />
            <span>1è¡Œç›®ã«ãƒ˜ãƒƒãƒ€ã‚’è¿½åŠ </span>
          </label>
          <label class="checkbox-wrapper">
            <input type="checkbox" id="flatten" checked />
            <span>ãƒã‚¹ãƒˆã‚’ãƒ•ãƒ©ãƒƒãƒˆåŒ– (a.b)</span>
          </label>
        </div>
        <div class="text-sm text-muted" style="margin-left: auto;">
          <span id="statusMsg" class="font-bold"></span>
        </div>
      </div>
    </div>

    <div class="split-pane">
      <!-- Input Column -->
      <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold">JSON å…¥åŠ›</h2>
          <button id="btnClear" class="text-sm text-muted hover:text-danger">ã‚¯ãƒªã‚¢</button>
        </div>
        <textarea id="input" class="code-editor" style="height: 500px;" placeholder='JSONã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...
ä¾‹:
[
  {"id":1, "name":"Alice"},
  {"id":2, "name":"Bob"}
]'></textarea>
        <div id="errorMsg" class="alert alert-warning mt-2" style="display:none"></div>
      </div>

      <!-- Output Column -->
      <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold">CSV çµæœ</h2>
          <div class="flex gap-2">
            <button class="btn btn-secondary btn-sm" id="btnCopy" disabled>ã‚³ãƒ”ãƒ¼</button>
            <button class="btn btn-primary btn-sm" id="btnDownload" disabled>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
          </div>
        </div>
        <textarea id="output" class="code-editor" readonly style="height: 500px;"
          placeholder="ã“ã“ã«CSVãŒè¡¨ç¤ºã•ã‚Œã¾ã™"></textarea>
      </div>
    </div>

  </main>

  <footer class="site-footer">
    <div class="container text-center">
      <div class="flex justify-center gap-4 mb-4 text-sm text-muted">
        <a href="/tools/">ãƒ„ãƒ¼ãƒ«ä¸€è¦§</a>
        <a href="/about/">ã“ã®ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a>
        <a href="/privacy/">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
      </div>
      <div class="text-xs text-muted">
        &copy; <span id="year">2026</span> ConvertFileBox. <br>
        å¤‰æ›çµæœã®æ­£ç¢ºæ€§ã¯ä¿è¨¼ã—ã¾ã›ã‚“ï¼ˆè‡ªå·±è²¬ä»»ã§ã”åˆ©ç”¨ãã ã•ã„ï¼‰ã€‚
      </div>
    </div>
  </footer>

  <script src="/assets/js/ui.js"></script>
  <script>
    const $ = (id) => document.getElementById(id);

    const inputEl = $("input");
    const outputEl = $("output");
    const errorMsgEl = $("errorMsg");
    const statusEl = $("statusMsg");

    const delimEl = $("delim");
    const includeHeaderEl = $("includeHeader");
    const flattenEl = $("flatten");

    const btnCopy = $("btnCopy");
    const btnDownload = $("btnDownload");
    const btnClear = $("btnClear");
    const btnSample = $("btnSample");

    let lastCsv = "";
    let lastFileBase = "json_to_csv";
    let debounceTimer = null;

    function setError(text) {
      if (!text) {
        errorMsgEl.style.display = "none";
        return;
      }
      errorMsgEl.textContent = text;
      errorMsgEl.style.display = "block";
    }

    function setStatus(text) {
      statusEl.textContent = text;
    }

    function normalizeDelim(v) {
      return v === "tab" ? "\t" : v;
    }

    function isPlainObject(x) {
      return x && typeof x === "object" && !Array.isArray(x);
    }

    function flattenObject(obj, prefix = "", out = {}) {
      for (const [k, v] of Object.entries(obj)) {
        const key = prefix ? `${prefix}.${k}` : k;
        if (isPlainObject(v)) {
          flattenObject(v, key, out);
        } else if (Array.isArray(v)) {
          out[key] = JSON.stringify(v);
        } else {
          out[key] = v;
        }
      }
      return out;
    }

    function collectHeaders(rows) {
      const set = new Set();
      for (const r of rows) {
        for (const k of Object.keys(r)) set.add(k);
      }
      return Array.from(set);
    }

    function csvEscape(value, delimChar) {
      const s = (value === null || value === undefined) ? "" : String(value);
      const needs = s.includes('"') || s.includes("\n") || s.includes("\r") || s.includes(delimChar);
      if (!needs) return s;
      return '"' + s.replace(/"/g, '""') + '"';
    }

    function jsonToRows(inputText, doFlatten) {
      const raw = JSON.parse(inputText);
      let arr;
      if (Array.isArray(raw)) {
        arr = raw;
      } else if (isPlainObject(raw)) {
        arr = [raw];
      } else {
        arr = [{ value: raw }];
      }
      const rows = arr.map((x) => {
        if (isPlainObject(x)) return doFlatten ? flattenObject(x) : x;
        return { value: (Array.isArray(x) ? JSON.stringify(x) : x) };
      });
      return rows;
    }

    function buildCsv(rows, delimChar, includeHeader) {
      const headers = collectHeaders(rows);
      const lines = [];
      if (includeHeader) {
        lines.push(headers.map(h => csvEscape(h, delimChar)).join(delimChar));
      }
      for (const r of rows) {
        const line = headers.map(h => csvEscape(r[h], delimChar)).join(delimChar);
        lines.push(line);
      }
      return { csv: lines.join("\n"), headers, count: rows.length };
    }

    function run() {
      const text = (inputEl.value ?? "").trim();
      setError("");

      if (!text) {
        outputEl.value = "";
        btnCopy.disabled = true;
        btnDownload.disabled = true;
        lastCsv = "";
        setStatus("");
        return;
      }

      const delimChar = normalizeDelim(delimEl.value);
      const includeHeader = !!includeHeaderEl.checked;
      const doFlatten = !!flattenEl.checked;

      try {
        const rows = jsonToRows(text, doFlatten);
        const { csv, headers, count } = buildCsv(rows, delimChar, includeHeader);

        lastCsv = csv;
        outputEl.value = csv;

        btnCopy.disabled = !lastCsv;
        btnDownload.disabled = !lastCsv;
        setStatus(`${count}è¡Œ / ${headers.length}åˆ— å¤‰æ›å®Œäº†`);
        lastFileBase = "json_to_csv";
      } catch (e) {
        // console.error(e);
        // JSONãƒ‘ãƒ¼ã‚¹ä¸­ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ã€é™ã‹ã«ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ã‹ã€ãƒ‡ãƒã‚¦ãƒ³ã‚¹ä¸­ã¯ç„¡è¦–ã™ã‚‹
        // ã“ã“ã§ã¯æ˜ç¤ºçš„ã«ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã›ãšã€æˆåŠŸæ™‚ã®ã¿æ›´æ–°ã™ã‚‹æ‰‹ã‚‚ã‚ã‚‹ãŒã€
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“çš„ã«ã¯ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã»ã†ãŒã„ã„å ´åˆã‚‚ã‚ã‚‹ã€‚
        // ãŸã ã—å…¥åŠ›ä¸­ã¯ã†ã‚‹ã•ã„ã®ã§ã€SyntaxErrorãªã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã ã‘å‡ºã™ã€‚
        outputEl.value = ""; // ã‚¯ãƒªã‚¢ã™ã‚‹ã‹ã€å‰ã®ã‚’æ®‹ã™ã‹ã€‚ã‚¯ãƒªã‚¢ã™ã‚‹ã»ã†ãŒèª¤è§£ãŒãªã„ã€‚
        btnCopy.disabled = true;
        btnDownload.disabled = true;
        lastCsv = "";
        setStatus("ã‚¨ãƒ©ãƒ¼");
        setError("JSONã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ (Syntax Error)");
      }
    }

    function scheduleRun() {
      if (debounceTimer) clearTimeout(debounceTimer);
      debounceTimer = setTimeout(run, 500); // JSONå…¥åŠ›ãªã®ã§å°‘ã—é•·ã‚ã«å¾…ã¤
    }

    // Events
    inputEl.addEventListener("input", scheduleRun);
    delimEl.addEventListener("change", run);
    includeHeaderEl.addEventListener("change", run);
    flattenEl.addEventListener("change", run);

    btnCopy.addEventListener("click", async () => {
      if (!lastCsv) return;
      copyToClipboard(lastCsv, btnCopy);
    });

    btnDownload.addEventListener("click", () => {
      if (!lastCsv) return;
      const blob = new Blob([lastCsv], { type: "text/csv;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `${lastFileBase}.csv`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    btnClear.addEventListener("click", () => {
      inputEl.value = "";
      run();
    });

    btnSample.addEventListener("click", () => {
      inputEl.value = JSON.stringify([
        { id: 1, name: "Alice", age: 30, meta: { city: "Tokyo", tags: ["a", "b"] } },
        { id: 2, name: "Bob", age: 25, meta: { city: "Osaka", tags: ["x"] } }
      ], null, 2);
      run();
    });
  </script>
</body>

</html>