<!doctype html>
<html lang="ja-jp">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow" />

  <title>JSON to CSV 変換｜Excel用に一括整形・フラット化【完全無料】</title>
  <meta name="description"
    content="JSON（高度・オブジェクト）をCSVに変換。ヘッダー自動作成・区切り文字指定・ネストのフラット化・ダウンロード対応。無料・ブラウザ完結でインストール不要。入力データはサーバーに送信しません。" />
  <link rel="canonical" href="https://www.convertfilebox.net/ja-jp/tools/json-to-csv/" />
  <link rel="alternate" hreflang="ja-jp" href="https://www.convertfilebox.net/ja-jp/tools/json-to-csv/" />
  <link rel="alternate" hreflang="en-us" href="https://www.convertfilebox.net/en-us/tools/json-to-csv/" />

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2739559953649909"
    crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2M7JXDP7J8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-2M7JXDP7J8');
  </script>

  <style>
    .form-select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.9375rem;
      background-color: white;
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9375rem;
      cursor: pointer;
    }

    .split-pane {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    @media (min-width: 960px) {
      .split-pane {
        grid-template-columns: 1fr 1fr;
      }
    }

    /* 技術解説用スタイル */
    .technical-content {
      margin-top: 4rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border);
      line-height: 1.8;
    }

    .technical-content h2 {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      color: var(--text-main);
    }

    .technical-content h3 {
      font-size: 1.125rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: var(--text-main);
      border-left: 4px solid var(--primary);
      padding-left: 1rem;
    }

    .technical-content p {
      margin-bottom: 1rem;
      color: var(--text-muted);
    }

    .technical-content ul {
      margin-bottom: 1.5rem;
      padding-left: 1.5rem;
    }

    .technical-content li {
      margin-bottom: 0.5rem;
      color: var(--text-muted);
    }
  </style>
</head>

<body>

  <site-header></site-header>

  <main class="container mt-8 mb-8" style="max-width: 1280px;">
    <div class="text-center mb-8">
      <h1>JSON to CSV 変換（階層フラット化・Excel対応）</h1>
      <p class="text-muted mt-2">ネストされたJSONも高度なアルゴリズムで自動フラット化し、Excelで扱いやすいCSVへ変換します。</p>
      <div class="flex justify-center gap-4 mt-4">
        <span class="tag">サーバー送信なし</span>
        <button id="btnSample" class="text-sm text-primary"
          style="background:none; border:none; text-decoration:underline; cursor:pointer;">サンプルを入力する</button>
      </div>
    </div>

    <!-- Standard Security Block -->
    <section class="panel-security mb-8">
      <h2 class="text-lg font-bold mb-4">🛡️ セキュリティに関するお約束</h2>
      <p class="mb-4 font-bold">当サイトでは、入力されたデータが一瞬たりとも外部サーバーへ送信されることはありません。</p>
      <ul class="list-disc list-inside text-sm text-muted pl-4">
        <li>すべての解析・変換ロジックはあなたのブラウザ（JavaScript）内で実行されます。</li>
        <li>機密性の高いログデータや個人情報を含むCSVなども、安心して処理いただけます。</li>
        <li>入力された内容はページを閉じた瞬間にメモリから消去され、記録も残りません。</li>
      </ul>
    </section>

    <!-- ツールバー -->
    <div class="tool-config-bar mb-6">
      <div class="form-group">
        <label class="text-xs font-bold text-muted" for="delim">区切り文字</label>
        <select id="delim" class="form-select">
          <option value="," selected>カンマ (,)</option>
          <option value="tab">タブ (\t)</option>
          <option value=";">セミコロン (;)</option>
        </select>
      </div>
      <div class="form-group-inline">
        <label class="checkbox-wrapper">
          <input type="checkbox" id="includeHeader" checked />
          <span>見出し（ヘッダー）を含める</span>
        </label>
        <label class="checkbox-wrapper">
          <input type="checkbox" id="flatten" checked />
          <span>ネストした構造を平坦化（フラット化）</span>
        </label>
      </div>
      <div class="text-sm text-muted" style="margin-left: auto;">
        <span id="statusMsg" class="font-bold"></span>
      </div>
    </div>

    <div class="split-pane">
      <!-- 入力カラム -->
      <div class="flex flex-col gap-2">
        <div class="toolbar">
          <h2 class="text-lg font-bold">JSON 入力</h2>
          <button id="btnClear" class="btn btn-danger-ghost btn-sm">入力をクリア</button>
        </div>
        <textarea id="input" class="code-editor" style="height: 500px;" placeholder='ここにJSONをペーストしてください。'></textarea>
        <div id="errorMsg" class="alert alert-warning mt-2" style="display:none"></div>
      </div>

      <!-- 出力カラム -->
      <div class="flex flex-col gap-2">
        <div class="toolbar">
          <h2 class="text-lg font-bold">CSV 出力結果</h2>
          <div class="flex gap-2">
            <button class="btn btn-secondary btn-sm" id="btnCopy" disabled>コピー</button>
            <button class="btn btn-primary btn-sm" id="btnDownload" disabled>ダウンロード</button>
          </div>
        </div>
        <textarea id="output" class="code-editor" readonly style="height: 500px;"
          placeholder="ここに変換されたCSVが表示されます。"></textarea>
      </div>
    </div>

    <!-- コンテンツ強化セクション (AdSense対策: 1,000文字以上の独自解説) -->
    <article class="technical-content">
      <h2>技術解説：JSONからCSVへの変換と構造の平坦化</h2>
      <p>
        モダンなAPIやWebアプリケーションのフロントエンドにおいて、JSON（JavaScript Object
        Notation）はデータのデファクトスタンダードです。しかし、ビジネスの現場やデータ分析のプロセスにおいては、依然としてExcelやGoogleスプレッドシート、さらには伝統的なRDBMS（リレーショナルデータベース）へのインポートに適したCSV（Comma-Separated
        Values）形式が必要とされます。
      </p>

      <h3>階層構造（JSON）を二次元表（CSV）にする挑戦</h3>
      <p>
        JSONの最大の特徴は「ネスト（階層構造）」と「配列」です。例えば、ユーザー情報の中に複数の連絡先や住所がオブジェクトとして含まれている場合、これを水平な一行のCSVにするためには、構造を「フラット化（Flattening）」する必要があります。
      </p>
      <p>
        本ツールに搭載された「ネストをフラット化」機能は、再帰的なアルゴリズムを用いて全てのプロパティを抽出し、<code>user.address.city</code>
        のようなドット記法で新しい列名を生成します。これにより、どんなに複雑な階層を持つJSONデータであっても、データの欠損を最小限に抑えつつ、スプレッドシートで解析可能な形式へと再構成します。
      </p>

      <h3>RFC 8259準拠のパースとセキュリティ</h3>
      <p>
        安全なデータ変換のためには、厳密なJSONパーサーが不可欠です。本ツールはブラウザ標準の <code>JSON.parse</code>（ECMAScript/RFC
        8259準拠）を利用しており、構文エラーが発生した場合には、該当箇所での入力を即座に検知し、適切なフィードバックを返します。
      </p>
      <p>
        <strong>セキュリティの徹底：</strong>
        本ツールは「ブラウザ完結型」です。世の中にある多くの変換サイトは、大きなJSONデータを「解析」という名目で自社サーバーに送信し、そこで処理を行っています。ConvertFileBoxは、JavaScriptのメモリ管理機能を活用し、入力データを一切サーバーに送付しないことで、機密情報の漏洩リスクを物理的に遮断しています。
      </p>

      <h3>Excel互換性とエスケープ処理</h3>
      <p>
        単なるカンマ区切りでは、変換結果は「壊れたデータ」になりかねません。CSV形式において、データの中にカンマが含まれていたり、改行が含まれていたりする場合、それらはダブルクォーテーション（"）で囲われ、クォート自体は二重（""）にすることでエスケープされる必要があります（RFC
        4180）。
      </p>
      <p>
        当エンジニアリングチームは、Excel等の主要なアプリケーションが正しく読み込めるよう、厳格なクォーティングルールを実装しています。これにより、住所の中に「～ビル
        2,3階」といったカンマが含まれていても、インポート時に列がずれることなく正確に復元されます。
      </p>

      <h3>よくある質問 (FAQ)</h3>
      <div class="mt-4">
        <h4 class="font-bold">Q. 巨大なJSONファイルを読み込めますか？</h4>
        <p class="text-sm">A.
          ブラウザ上でJavaScriptを動かす性質上、端末のメモリ（RAM）量に依存します。数MB程度のテキストデータであれば瞬時に処理しますが、数百MBを超える場合は、処理速度が低下したりブラウザが警告を出す場合があります。
        </p>

        <h4 class="font-bold">Q. 配列の中に配列がある場合はどうなりますか？</h4>
        <p class="text-sm">A. 文字列化（JSON.stringify）されて一つのセルに格納されます。これは、二次元の表形式であるCSVに、三次元以上の構造を完全にマッピングすることが論理的に難しいためです。
        </p>

        <h4 class="font-bold">Q. 出力されたCSVの文字コードは？</h4>
        <p class="text-sm">A. デフォルトはUTF-8です。Excelで開く際に文字化けする場合は、当サイトの「CSV文字コード変換」ツールを併用してShift-JISに変換することをお勧めします。</p>
      </div>

      <h3 class="mt-8">効率的なワークフローのために</h3>
      <p>
        開発の現場では、APIのデバッグ中にレスポンスを素早く可視化したい場面が多くあります。そのような時、ブラウザのデベロッパーツールからJSONをコピーし、ここにペーストして「コピー」ボタンを押すだけで、そのままスプレッドシートへ貼り付けられる。この「一瞬の利便性」を、最高のセキュリティと共に提供し続けることがConvertFileBoxの誇りです。
      </p>
    </article>

  </main>

  <site-footer></site-footer>

  <script src="/assets/js/ui.js"></script>
  <script>
    const $ = (id) => document.getElementById(id);

    const inputEl = $("input");
    const outputEl = $("output");
    const errorMsgEl = $("errorMsg");
    const statusEl = $("statusMsg");

    const delimEl = $("delim");
    const includeHeaderEl = $("includeHeader");
    const flattenEl = $("flatten");

    const btnCopy = $("btnCopy");
    const btnDownload = $("btnDownload");
    const btnClear = $("btnClear");
    const btnSample = $("btnSample");

    let lastCsv = "";
    let lastFileBase = "json_to_csv";
    let debounceTimer = null;

    function setError(text) {
      if (!text) {
        errorMsgEl.style.display = "none";
        return;
      }
      errorMsgEl.textContent = text;
      errorMsgEl.style.display = "block";
    }

    function setStatus(text) {
      statusEl.textContent = text;
    }

    function normalizeDelim(v) {
      return v === "tab" ? "\t" : v;
    }

    function isPlainObject(x) {
      return x && typeof x === "object" && !Array.isArray(x);
    }

    function flattenObject(obj, prefix = "", out = {}) {
      for (const [k, v] of Object.entries(obj)) {
        const key = prefix ? `${prefix}.${k}` : k;
        if (isPlainObject(v)) {
          flattenObject(v, key, out);
        } else if (Array.isArray(v)) {
          out[key] = JSON.stringify(v);
        } else {
          out[key] = v;
        }
      }
      return out;
    }

    function collectHeaders(rows) {
      const set = new Set();
      for (const r of rows) {
        for (const k of Object.keys(r)) set.add(k);
      }
      return Array.from(set);
    }

    function csvEscape(value, delimChar) {
      const s = (value === null || value === undefined) ? "" : String(value);
      const needs = s.includes('"') || s.includes("\n") || s.includes("\r") || s.includes(delimChar);
      if (!needs) return s;
      return '"' + s.replace(/"/g, '""') + '"';
    }

    function jsonToRows(inputText, doFlatten) {
      const raw = JSON.parse(inputText);
      let arr;
      if (Array.isArray(raw)) {
        arr = raw;
      } else if (isPlainObject(raw)) {
        arr = [raw];
      } else {
        arr = [{ value: raw }];
      }
      const rows = arr.map((x) => {
        if (isPlainObject(x)) return doFlatten ? flattenObject(x) : x;
        return { value: (Array.isArray(x) ? JSON.stringify(x) : x) };
      });
      return rows;
    }

    function buildCsv(rows, delimChar, includeHeader) {
      const headers = collectHeaders(rows);
      const lines = [];
      if (includeHeader) {
        lines.push(headers.map(h => csvEscape(h, delimChar)).join(delimChar));
      }
      for (const r of rows) {
        const line = headers.map(h => csvEscape(r[h], delimChar)).join(delimChar);
        lines.push(line);
      }
      return { csv: lines.join("\n"), headers, count: rows.length };
    }

    function run() {
      const text = (inputEl.value ?? "").trim();
      setError("");

      if (!text) {
        outputEl.value = "";
        btnCopy.disabled = true;
        btnDownload.disabled = true;
        lastCsv = "";
        setStatus("");
        return;
      }

      const delimChar = normalizeDelim(delimEl.value);
      const includeHeader = !!includeHeaderEl.checked;
      const doFlatten = !!flattenEl.checked;

      try {
        const rows = jsonToRows(text, doFlatten);
        const { csv, headers, count } = buildCsv(rows, delimChar, includeHeader);

        lastCsv = csv;
        outputEl.value = csv;

        btnCopy.disabled = !lastCsv;
        btnDownload.disabled = !lastCsv;
        setStatus(`${count}行 / ${headers.length}列 変換完了`);
        lastFileBase = "json_to_csv";
      } catch (e) {
        outputEl.value = "";
        btnCopy.disabled = true;
        btnDownload.disabled = true;
        lastCsv = "";
        setStatus("エラー");
        setError("JSONの形式が正しくありません (Syntax Error)");
      }
    }

    function scheduleRun() {
      if (debounceTimer) clearTimeout(debounceTimer);
      debounceTimer = setTimeout(run, 500);
    }

    // Events
    inputEl.addEventListener("input", scheduleRun);
    delimEl.addEventListener("change", run);
    includeHeaderEl.addEventListener("change", run);
    flattenEl.addEventListener("change", run);

    btnCopy.addEventListener("click", () => {
      if (!lastCsv) return;
      const textArea = document.createElement("textarea");
      textArea.value = lastCsv;
      document.body.appendChild(textArea);
      textArea.select();
      try {
        document.execCommand('copy');
        const oldText = btnCopy.textContent;
        btnCopy.textContent = "コピー完了！";
        setTimeout(() => btnCopy.textContent = oldText, 2000);
      } catch (err) {
        console.error('Copy failed', err);
      }
      document.body.removeChild(textArea);
    });

    btnDownload.addEventListener("click", () => {
      if (!lastCsv) return;
      const blob = new Blob([lastCsv], { type: "text/csv;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `${lastFileBase}.csv`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    btnClear.addEventListener("click", () => {
      inputEl.value = "";
      run();
    });

    btnSample.addEventListener("click", () => {
      inputEl.value = JSON.stringify([
        { id: 1, name: "Alice", age: 30, meta: { city: "Tokyo", tags: ["a", "b"] } },
        { id: 2, name: "Bob", age: 25, meta: { city: "Osaka", tags: ["x"] } }
      ], null, 2);
      run();
    });
  </script>
</body>

</html>