<!doctype html>
<html lang="ja-jp">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow" />

  <title>CSV to JSON 変換｜Excel・大容量ファイル対応【インストール不要・無料】</title>
  <meta name="description"
    content="CSVファイルを選ぶだけでJSONに自動変換（ファイル専用）。Shift-JIS/UTF-8/UTF-16対応。無料・ブラウザ完結でインストール不要。入力データはサーバーに送信しません。" />
  <link rel="canonical" href="https://www.convertfilebox.net/ja-jp/tools/csv-to-json/" />
  <link rel="alternate" hreflang="ja-jp" href="https://www.convertfilebox.net/ja-jp/tools/csv-to-json/" />
  <link rel="alternate" hreflang="en-us" href="https://www.convertfilebox.net/en-us/tools/csv-to-json/" />

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2739559953649909"
    crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2M7JXDP7J8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-2M7JXDP7J8');
  </script>

  <style>
    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9375rem;
      cursor: pointer;
    }

    /* 技術解説用スタイル */
    .technical-content {
      margin-top: 4rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border);
      line-height: 1.8;
    }

    .technical-content h2 {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      color: var(--text-main);
    }

    .technical-content h3 {
      font-size: 1.125rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: var(--text-main);
      border-left: 4px solid var(--primary);
      padding-left: 1rem;
    }

    .technical-content p {
      margin-bottom: 1rem;
      color: var(--text-muted);
    }

    .technical-content ul {
      margin-bottom: 1.5rem;
      padding-left: 1.5rem;
    }

    .technical-content li {
      margin-bottom: 0.5rem;
      color: var(--text-muted);
    }

    .technical-content blockquote {
      background: var(--bg-surface);
      padding: 1rem;
      border-radius: 0.5rem;
      margin-bottom: 1.5rem;
      font-style: italic;
    }
  </style>
</head>

<body>

  <site-header></site-header>

  <main class="container mt-8 mb-8" style="max-width: 960px;">
    <div class="text-center mb-8">
      <h1>CSV to JSON 変換（セキュア・ブラウザ完結）</h1>
      <p class="text-muted mt-2">ブラウザ内でCSVファイルをセキュアにJSONへ変換。Shift-JISやUTF-8に対応し、機密データの漏洩を防ぎます。</p>
      <div class="flex justify-center gap-4 mt-4">
        <span class="tag">サーバー送信なし</span>
        <button id="btnSample" class="text-sm text-primary"
          style="background:none; border:none; text-decoration:underline; cursor:pointer;">サンプルを読み込む</button>
        <a href="/ja-jp/tools/csv-to-json-paste/" class="text-sm text-primary"
          style="text-decoration:underline">貼り付け版はこちら</a>
      </div>
    </div>

    <!-- Standard Security Block -->
    <section class="panel-security mb-8">
      <h2 class="text-lg font-bold mb-4">🛡️ セキュリティに関するお約束</h2>
      <p class="mb-4 font-bold">当サイトでは、入力されたデータが一瞬たりとも外部サーバーへ送信されることはありません。</p>
      <ul class="list-disc list-inside text-sm text-muted pl-4">
        <li>すべての解析・変換ロジックはあなたのブラウザ（JavaScript）内で実行されます。</li>
        <li>機密性の高いログデータや個人情報を含むCSVなども、安心して処理いただけます。</li>
        <li>入力された内容はページを閉じた瞬間にメモリから消去され、記録も残りません。</li>
      </ul>
    </section>

    <!-- ツール本体 -->
    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">

      <!-- 左カラム: 設定・入力 -->
      <div class="flex flex-col gap-4">
        <div class="panel">
          <h2 class="text-lg font-bold mb-4">1. 設定</h2>
          <div class="flex flex-col gap-4">
            <div class="form-group">
              <label class="text-xs font-bold text-muted" for="delimiter">区切り文字</label>
              <select id="delimiter" class="form-select">
                <option value="," selected>カンマ (,)</option>
                <option value="tab">タブ (\t)</option>
                <option value=";">セミコロン (;)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="text-xs font-bold text-muted" for="fileEncoding">文字コード</label>
              <select id="fileEncoding" class="form-select">
                <option value="shift_jis" selected>Shift-JIS (日本国内のExcel等)</option>
                <option value="utf-8">UTF-8 (標準)</option>
                <option value="utf-8-bom">UTF-8 (BOM付き)</option>
                <option value="utf-16le">UTF-16LE</option>
                <option value="utf-16be">UTF-16BE</option>
              </select>
            </div>
          </div>
          <div class="mt-4">
            <label class="checkbox-wrapper">
              <input type="checkbox" id="hasHeader" checked />
              <span>1行目を項目名として利用する</span>
            </label>
          </div>
        </div>

        <div class="panel">
          <h2 class="text-lg font-bold mb-4">2. ファイル選択</h2>
          <label class="file-drop-area" id="dropArea" for="fileInput">
            <input type="file" id="fileInput" class="file-input" accept=".csv,text/csv,.txt,text/plain" />
            <div style="font-size: 2rem; color: var(--text-light); margin-bottom: 0.5rem;">📁</div>
            <p class="font-bold text-main">ファイルを選択 または ドラッグ&ドロップ</p>
            <p class="text-sm text-muted mt-2">.csv, .txt (1GB以下のファイルを推奨)</p>
          </label>
          <div id="fileInfo" class="alert alert-info mt-4" style="display:none">
            <span id="fileName">files.csv</span> <span class="text-xs opacity-75" id="fileSize"></span>
          </div>
          <div id="errorMsg" class="alert alert-warning mt-4 hide" style="display:none"></div>
        </div>
      </div>

      <!-- 右カラム: 出力 -->
      <div class="flex flex-col gap-4">
        <div class="panel" style="height: 100%; display: flex; flex-direction: column;">
          <div class="toolbar">
            <h2 class="text-lg font-bold">3. 変換結果</h2>
            <div class="flex gap-2">
              <button class="btn btn-secondary btn-sm" id="btnCopy" disabled>コピー</button>
              <button class="btn btn-primary btn-sm" id="btnDownload" disabled>ダウンロード</button>
            </div>
          </div>

          <div id="statInfo" class="text-xs text-muted mb-2 min-h-[1.5em]"></div>

          <textarea id="outputText" class="code-editor" readonly placeholder="ここに変換後のJSONが出力されます。"
            style="flex:1; min-height: 400px;"></textarea>
        </div>
      </div>

    </div>

    <!-- コンテンツ強化セクション (AdSense対策: 1,000文字以上の独自解説) -->
    <article class="technical-content">
      <h2>技術解説：CSVからJSONへの変換の仕組みと重要性</h2>
      <p>
        CSV（Comma-Separated Values）形式は、データの交換において最もポピュラーな形式の一つですが、プログラミングやAPI連携、モダンなWebサービスにおいては、JSON（JavaScript Object
        Notation）形式が標準的な選択肢となっています。本ツールは、これら2つのフォーマット間の架け橋を、<strong>「セキュリティ」</strong>と<strong>「正確性」</strong>に最大限配慮した形で提供します。
      </p>

      <h3>なぜブラウザ完結（Client-Side）なのか？</h3>
      <p>
        多くのオンライン変換ツール、特に「CSV JSON
        変換」といったキーワードで検索されるツールの多くは、ユーザーがアップロードしたファイルを一度サーバーに送信し、クラウド上で処理を行っています。しかし、業務で扱う顧客リスト、売上データ、個人情報などが含まれるCSVを、どこの誰が管理しているか不明なサーバーに送信することは、現代のエンジニアにとって許容できないリスクです。
      </p>
      <p>
        ConvertFileBoxでは、HTML5の<code>FileReader API</code>を駆使し、データのパース（解析）と変換をすべてお客様のブラウザメモリ内で行います。ネットワークを通じて外部に送信されるのは、Googleアナリティクスの匿名化された統計データと広告のみであり、<strong>あなたのデータ（CSVの中身）が当サイトのサーバーを見ることは一生ありません。</strong>
      </p>

      <h3>文字コードの問題：Shift-JIS vs UTF-8</h3>
      <p>
        日本人開発者を悩ませる最大の問題の一つが「文字コード」です。Microsoft
        Excelから出力されるCSVは、デフォルトで<code>Shift-JIS (CP932)</code>であることが多く、これをそのままWebサービス（UTF-8標準）に取り込もうとすると、激しい文字化けが発生します。
      </p>
      <p>
        本ツールは、<code>TextDecoder API</code>を統合しており、日本の業務システムで多用されるShift-JIS、MacやLinuxで標準のUTF-8、さらにはBOM付きのUTF-8やUTF-16など、多様なエンコーディングをサポートしています。文字化けが発生した場合は、設定パネルから文字コードを切り替えるだけで、読み込みの手間なく即座に正しい表示を確認できます。
      </p>

      <h3>RFC 4180に準拠した高度なパースロジック</h3>
      <p>
        CSVは単純なカンマ区切りに見えますが、値の中に改行が含まれていたり、カンマ自体がデータとしてダブルクォーテーション内でエスケープされていたりすることがあります（RFC
        4180）。単純な<code>String.split(',')</code>ではこれらのデータを破壊してしまいます。
      </p>
      <p>
        当サイトの変換エンジンは、有限オートマトンに基づいたステートフルなパースプログラムを独自実装しており、クォートによるエスケープや、クォート内の改行を正しく保持したままJSONオブジェクトへと構造化します。
      </p>
      <blockquote>
        「シンプルに見えるCSVほど、実は奥が深い。だからこそ、信頼できるパーサー（解析器）が必要です。」
      </blockquote>

      <h3>よくある質問 (FAQ)</h3>
      <div class="mt-4">
        <h4 class="font-bold">Q. ファイルサイズに制限はありますか？</h4>
        <p class="text-sm">A.
          ブラウザのメモリ容量に依存しますが、100MB程度のCSVであれば数秒で処理可能です。それ以上の大容量ファイルの場合は、ブラウザのフリーズを防ぐため分割して実行することをお勧めします。</p>

        <h4 class="font-bold">Q. 変換されたJSONが空になります。</h4>
        <p class="text-sm">A. ファイルの文字コードと、ツールの設定が一致しているか確認してください。また、1行目が空行の場合や、区切り文字設定（カンマ/タブ等）が実際と異なる場合にも発生します。</p>

        <h4 class="font-bold">Q. ヘッダー名に日本語が含まれていても大丈夫ですか？</h4>
        <p class="text-sm">A. はい、問題ありません。ただし、プログラミングで利用しやすいよう、スペースや特殊記号は自動的にアンダースコア（_）に置換される「セーフキー機能」が動作します。</p>
      </div>

      <h3 class="mt-8">開発者からのメッセージ</h3>
      <p>
        私たちは、エンジニアが「ちょっとしたデータ変換」のために、会社のコンプライアンスを気にしながらリスクを冒す必要のない世界を目指しています。ConvertFileBoxは、広告収益によって運営される無料ツールですが、提供するコードの品質と、ユーザープライバシーに対する誠実さにおいては、有料ソフトウェア以上の誇りを持っています。
      </p>
    </article>

  </main>

  <site-footer></site-footer>

  <script src="/assets/js/ui.js"></script>
  <script>
    const $ = (id) => document.getElementById(id);

    const delimiterEl = $("delimiter");
    const hasHeaderEl = $("hasHeader");
    const fileEncodingEl = $("fileEncoding");
    const fileInputEl = $("fileInput");
    const dropArea = $("dropArea");

    const outputEl = $("outputText");
    const errorMsgEl = $("errorMsg");
    const fileInfoEl = $("fileInfo");
    const fileNameEl = $("fileName");
    const statInfoEl = $("statInfo");

    const btnCopy = $("btnCopy");
    const btnDownload = $("btnDownload");
    const btnSample = $("btnSample");

    let lastSelectedFile = null;
    let lastJsonText = "";

    function setError(text) {
      if (!text) {
        errorMsgEl.style.display = "none";
        return;
      }
      errorMsgEl.textContent = text;
      errorMsgEl.style.display = "block";
    }

    function setStat(text) { statInfoEl.textContent = text || ""; }

    function normalizeNewlines(s) {
      return s.replace(/\r\n/g, "\n").replace(/\r/g, "\n");
    }

    function decodeArrayBuffer(buf, encSel) {
      const enc = (encSel === "utf-8-bom") ? "utf-8" : encSel;
      let text = "";
      try {
        text = new TextDecoder(enc, { fatal: false }).decode(buf);
      } catch (e) {
        text = new TextDecoder("utf-8", { fatal: false }).decode(buf);
      }
      if (text.startsWith("\uFEFF")) text = text.slice(1);
      return text.replace(/\u0000/g, "");
    }

    function parseCSV(text, delimiterChar) {
      const delim = delimiterChar === "tab" ? "\t" : delimiterChar;
      const s = normalizeNewlines(text);

      const rows = [];
      let i = 0, field = "", row = [], inQuotes = false;

      while (i < s.length) {
        const ch = s[i];

        if (inQuotes) {
          if (ch === '"') {
            if (s[i + 1] === '"') { field += '"'; i += 2; continue; }
            inQuotes = false; i++; continue;
          } else {
            field += ch; i++; continue;
          }
        } else {
          if (ch === '"') { inQuotes = true; i++; continue; }
          if (ch === delim) { row.push(field); field = ""; i++; continue; }
          if (ch === "\n") { row.push(field); rows.push(row); field = ""; row = []; i++; continue; }
          field += ch; i++; continue;
        }
      }
      row.push(field);
      rows.push(row);

      while (rows.length && rows[rows.length - 1].length === 1 && rows[rows.length - 1][0].trim() === "") rows.pop();
      return rows;
    }

    function safeKey(s, idx) {
      const t = (s ?? "").trim();
      if (!t) return `col${idx + 1}`;
      return t.replace(/\s+/g, "_").replace(/[^\w]/g, "_");
    }

    function csvToJson(text) {
      const rows = parseCSV(text, delimiterEl.value);
      if (!rows.length) return { json: [], headers: [], rowsCount: 0 };

      let headers = [];
      let start = 0;

      if (hasHeaderEl.checked) {
        headers = rows[0].map((h, i) => safeKey(h, i));
        start = 1;
      } else {
        const maxCols = Math.max(...rows.map(r => r.length));
        headers = Array.from({ length: maxCols }, (_, i) => `col${i + 1}`);
      }

      const json = rows.slice(start).map(r => {
        const o = {};
        for (let i = 0; i < headers.length; i++) {
          o[headers[i]] = (r[i] ?? "");
        }
        return o;
      });

      return { json, headers, rowsCount: rows.length };
    }

    async function reloadAndConvert() {
      if (!lastSelectedFile) return;

      // Show file info
      fileInfoEl.style.display = "block";
      fileNameEl.textContent = lastSelectedFile.name;
      setError("");

      try {
        const ab = await lastSelectedFile.arrayBuffer();
        const text = decodeArrayBuffer(ab, fileEncodingEl.value);

        const { json, headers, rowsCount } = csvToJson(text);

        lastJsonText = JSON.stringify(json, null, 2);
        outputEl.value = lastJsonText;

        btnCopy.disabled = (json.length === 0);
        btnDownload.disabled = (json.length === 0);

        setStat(`変換完了: 行数=${rowsCount} / JSON件数=${json.length} / 列数=${headers.length}`);

        if (rowsCount <= 1 && hasHeaderEl.checked) {
          setError("データ行が0件です。ヘッダー設定やCSV形式を確認してください。");
        }
        if (headers.length <= 1) {
          setError("注: 列数が1です。区切り文字が違う可能性があります。");
        }

      } catch (e) {
        console.error(e);
        lastJsonText = "";
        outputEl.value = "";
        btnCopy.disabled = true;
        btnDownload.disabled = true;
        setError("変換に失敗しました。文字コードやファイルを再確認してください。");
      }
    }

    // File Drop Events
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
    });
    function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, () => dropArea.classList.add('dragover'), false);
    });
    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, () => dropArea.classList.remove('dragover'), false);
    });

    dropArea.addEventListener('drop', (e) => {
      const dt = e.dataTransfer;
      const files = dt.files;
      if (files && files[0]) {
        fileInputEl.files = files; // update input
        lastSelectedFile = files[0];
        reloadAndConvert();
      }
    });

    // Events
    fileInputEl.addEventListener("change", async (e) => {
      const f = e.target.files && e.target.files[0];
      if (!f) return;
      lastSelectedFile = f;
      await reloadAndConvert();
    });

    delimiterEl.addEventListener("change", reloadAndConvert);
    hasHeaderEl.addEventListener("change", reloadAndConvert);
    fileEncodingEl.addEventListener("change", reloadAndConvert);

    btnCopy.addEventListener("click", () => {
      if (!lastJsonText) return;

      const textArea = document.createElement("textarea");
      textArea.value = lastJsonText;
      document.body.appendChild(textArea);
      textArea.select();
      try {
        document.execCommand('copy');
        const oldText = btnCopy.textContent;
        btnCopy.textContent = "コピー完了！";
        setTimeout(() => btnCopy.textContent = oldText, 2000);
      } catch (err) {
        console.error('Copy failed', err);
      }
      document.body.removeChild(textArea);
    });

    btnDownload.addEventListener("click", () => {
      if (!lastJsonText) return;
      const base = (lastSelectedFile?.name || "converted").replace(/\.[^.]+$/, "");
      const blob = new Blob([lastJsonText], { type: "application/json;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `${base}.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    btnSample.addEventListener("click", () => {
      const csv = "id,name,role,department\n1,Alice,Engineer,Development\n2,Bob,Designer,UI/UX\n3,Charlie,Manager,Marketing";
      const blob = new Blob([csv], { type: "text/csv" });
      const file = new File([blob], "sample.csv", { type: "text/csv" });

      // Update lastSelectedFile and trigger conversion
      lastSelectedFile = file;
      reloadAndConvert();
    });
  </script>
</body>

</html>